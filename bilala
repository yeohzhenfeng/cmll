<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ğŸ„ èŠ‚æ—¥ç¥ç¦</title>

<style>
:root{
  --bg-a:#0f3d2e;
  --bg-b:#1f6f54;
  --bg-c:#0b2e22;
  --ink:#234c3b;
  --gold:#cfa24a;
  --glass: rgba(255,255,255,.92);
}

html,body{
  height:100%;
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  overflow:hidden;
  background:
    radial-gradient(900px 700px at 20% 10%, rgba(255,255,255,.12), transparent 60%),
    radial-gradient(800px 600px at 80% 20%, rgba(255,255,255,.08), transparent 55%),
    linear-gradient(135deg,var(--bg-a),var(--bg-b),var(--bg-c));
}

/* AI vibe: èƒŒæ™¯æ¸å˜ç¼“æ…¢æ¼‚ç§» */
.bg-shift{
  position:fixed; inset:-20%;
  background:
    radial-gradient(900px 700px at 20% 10%, rgba(255,255,255,.10), transparent 60%),
    radial-gradient(700px 550px at 70% 30%, rgba(207,162,74,.10), transparent 60%),
    radial-gradient(800px 600px at 40% 80%, rgba(255,255,255,.06), transparent 55%),
    linear-gradient(135deg,var(--bg-a),var(--bg-b),var(--bg-c));
  filter:saturate(1.1);
  animation:bgMove 18s ease-in-out infinite;
  pointer-events:none;
}
@keyframes bgMove{
  0%,100%{ transform: translate3d(0,0,0) scale(1.05); }
  50%{ transform: translate3d(-2.5%,2%,0) scale(1.08); }
}

.glow{
  position:fixed;
  width:580px;height:580px;
  border-radius:50%;
  top:-240px; right:-280px;
  background: radial-gradient(circle at 30% 30%, rgba(255,220,150,.26), transparent 62%);
  animation: drift 10s ease-in-out infinite;
  pointer-events:none;
  filter: blur(.2px);
}
@keyframes drift{
  0%,100%{ transform: translate(0,0); }
  50%{ transform: translate(-60px,45px); }
}

/* AI: è½»å¾®å…¨å±€å™ªç‚¹ï¼Œå¢åŠ è´¨æ„Ÿ */
.noise{
  position:fixed; inset:0;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='.10'/%3E%3C/svg%3E");
  mix-blend-mode:overlay;
  opacity:.25;
  pointer-events:none;
}

/* canvas ç²’å­ç½‘ç»œå±‚ */
#aiCanvas{
  position:fixed; inset:0;
  pointer-events:none;
  opacity:.55;
}

.snowflake{
  position:fixed;
  top:-10%;
  color:#fff;
  opacity:.85;
  pointer-events:none;
  animation: fall linear infinite;
}
@keyframes fall{
  from{ transform:translateY(-10vh); }
  to{ transform:translateY(110vh); }
}

.wrap{
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:22px;
}

.card{
  width:min(380px,92vw);
  background: var(--glass);
  border-radius:28px;
  padding:34px 28px 26px;
  text-align:center;
  box-shadow:0 26px 70px rgba(0,0,0,.38);
  border:1px solid rgba(255,255,255,.55);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  position:relative;
  overflow:hidden;
  transform: translateZ(0);
}

/* AI: å¡ç‰‡ä¸Šæ–¹â€œå…‰å¸¦æ‰«è¿‡â€ */
.card::before{
  content:"";
  position:absolute;
  inset:-30% -60%;
  background: linear-gradient(110deg, transparent 35%, rgba(255,255,255,.55) 45%, transparent 55%);
  transform: translateX(-40%);
  animation: sheen 4.6s ease-in-out infinite;
  opacity:.55;
  pointer-events:none;
}
@keyframes sheen{
  0%{ transform: translateX(-55%) rotate(0.01deg); opacity:.0; }
  18%{ opacity:.5; }
  45%{ opacity:.3; }
  100%{ transform: translateX(55%) rotate(0.01deg); opacity:0; }
}

.badge{
  display:inline-block;
  font-size:12px;
  color:#fff;
  background:var(--gold);
  padding:4px 10px;
  border-radius:999px;
  margin-bottom:12px;
  box-shadow: 0 8px 18px rgba(207,162,74,.25);
}

h1{ margin:0 0 10px; color:#1f5a44; }

.sub{
  font-size:12px;
  color:rgba(31,90,68,.78);
  margin-top:-2px;
}

.text{
  min-height:150px;
  white-space:pre-line;
  color:var(--ink);
  line-height:1.7;
  font-size:16px;
  margin-top:14px;
}

/* AI: æ‰“å­—æ—¶é—ªçƒå…‰æ ‡ */
.cursor{
  display:inline-block;
  width:8px;
  height:18px;
  vertical-align:-3px;
  background: rgba(31,90,68,.55);
  margin-left:2px;
  border-radius: 3px;
  animation: blink 1s steps(2,end) infinite;
}
@keyframes blink{
  50%{ opacity:0; }
}

.actions{
  margin-top:16px;
  display:flex;
  gap:10px;
  justify-content:center;
  flex-wrap:wrap;
}

.btn{
  padding:10px 16px;
  border-radius:999px;
  border:none;
  background:var(--gold);
  color:#fff;
  font-weight:700;
  cursor:pointer;
}

.btn.ghost{
  background:#fff;
  color:#1f6f54;
  border:1px solid rgba(31,111,84,.35);
}

.from{
  margin-top:14px;
  font-size:14px;
  color:#1f5a44;
  opacity:.95;
}

/* å°æç¤º */
.tip{
  margin-top:10px;
  font-size:12px;
  color:rgba(35,76,59,.65);
}
</style>
</head>

<body>

<div class="bg-shift"></div>
<canvas id="aiCanvas"></canvas>
<div class="glow"></div>
<div class="noise"></div>

<div class="wrap">
  <div class="card" id="card">
    <div class="badge" id="badge">ğŸ„ èŠ‚æ—¥é—®å€™</div>
    <h1 id="title">ç»™ä½ </h1>
    <div class="sub">ï¼ˆä¸ç”¨ç‚¹ç»§ç»­ï¼Œä¼šè‡ªåŠ¨æ’­æ”¾æ–‡å­—ï¼‰</div>

    <div class="text" id="text"></div>

    <div class="actions">
      <button class="btn ghost" id="skipBtn">â­ï¸ è·³åˆ°ä¸‹ä¸€å¥</button>
      <button class="btn ghost" id="musicBtn">ğŸµ æ’­æ”¾åœ£è¯æ­Œ</button>
    </div>

    <div class="tip">ä½ ä¹Ÿå¯ä»¥ç‚¹å‡»å¡ç‰‡ï¼Œç›´æ¥åˆ‡æ¢ä¸‹ä¸€å¥ã€‚</div>
    <div class="from">â€”â€” ZF</div>
  </div>
</div>

<audio id="bgm" preload="auto" playsinline loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/12/06/audio_6a0c7b3c25.mp3?filename=christmas-village-ambient-124008.mp3" type="audio/mpeg">
</audio>

<script>
/* ===== æ ‡è¯†ï¼ˆä»Šå¤©/è¿‡æœŸï¼‰ ===== */
const now = new Date();
const endTime = new Date(now);
endTime.setHours(24,0,0,0);
document.getElementById("badge").textContent =
  now < endTime ? "ğŸ„ åœ£è¯å¿«ä¹" : "â„ï¸ èŠ‚æ—¥é—®å€™";

/* ===== ç¥ç¦è¯­ï¼šåŒäº‹/æœ‹å‹éƒ½é€‚ç”¨ï¼ˆæ™®é€šã€ä¸å°´å°¬ï¼‰ ===== */
const messages = [
  "å—¨ ğŸ‘‹\nåœ£è¯å¿«ä¹ ğŸ„",
  "å¿™äº†ä¸€å¹´ï¼Œ\nè¾›è‹¦å•¦ï½",
  "æ„¿ä½ æ¥ä¸‹æ¥çš„æ—¥å­ï¼š\nç¡å¾—é¦™ã€åƒå¾—å¥½ã€å¿ƒæƒ…ä¹Ÿæ›´å¥½ ğŸ™‚",
  "æ„¿çƒ¦æ¼å°‘ä¸€ç‚¹ï¼Œ\nå¥½è¿å¤šä¸€ç‚¹ âœ¨",
  "æ„¿å·¥ä½œé¡ºé¡ºåˆ©åˆ©ï¼Œ\nç”Ÿæ´»å¼€å¼€å¿ƒå¿ƒã€‚",
  "æœ€åä¸€å¥ï¼š\nå¹³å®‰å–œä¹ï¼Œä¸‡äº‹èƒœæ„ â„ï¸"
];

/* ===== è‡ªåŠ¨æ’­æ–‡æ¡ˆï¼ˆæ— éœ€ç»§ç»­æŒ‰é’®ï¼‰ ===== */
const textBox = document.getElementById("text");
const card = document.getElementById("card");
const skipBtn = document.getElementById("skipBtn");

let step = 0;
let typing = false;
let timerNext = null;

function clearTimers(){
  if(timerNext) { clearTimeout(timerNext); timerNext = null; }
}

function typeText(msg, speed = 52){
  typing = true;
  textBox.textContent = "";
  const cursor = document.createElement("span");
  cursor.className = "cursor";
  textBox.appendChild(cursor);

  let i = 0;
  function tick(){
    if(i < msg.length){
      cursor.remove();
      textBox.textContent += msg[i++];
      textBox.appendChild(cursor);
      setTimeout(tick, speed);
    }else{
      typing = false;
      // æ‰“å®Œååœç•™ä¸€ä¸‹å†è‡ªåŠ¨ä¸‹ä¸€å¥
      clearTimers();
      timerNext = setTimeout(nextMessage, 1600);
    }
  }
  tick();
}

function nextMessage(){
  if(typing) return; // æ‰“å­—ä¸­ä¸åˆ‡
  step = (step + 1) % messages.length;
  typeText(messages[step]);
}

function startSequence(){
  step = 0;
  typeText(messages[step]);
}

skipBtn.addEventListener("click", () => {
  clearTimers();
  if(typing){
    // å¦‚æœæ­£åœ¨æ‰“å­—ï¼Œç›´æ¥ä¸€æ¬¡æ€§æ˜¾ç¤ºå®Œæ•´å†…å®¹ï¼Œå†è¿›å…¥ä¸‹ä¸€å¥
    const msg = messages[step];
    textBox.textContent = msg;
    typing = false;
    timerNext = setTimeout(nextMessage, 700);
  }else{
    nextMessage();
  }
});

card.addEventListener("click", (e) => {
  // é¿å…ç‚¹åˆ°æŒ‰é’®ä¹Ÿè§¦å‘å¡ç‰‡ç‚¹å‡»
  if(e.target.tagName.toLowerCase() === "button") return;
  skipBtn.click();
});

startSequence();

/* ===== é›ªèŠ± ===== */
for(let i = 0; i < 28; i++){
  const s = document.createElement("div");
  s.className = "snowflake";
  s.textContent = ["â„","â…","â†"][Math.floor(Math.random()*3)];
  s.style.left = Math.random() * 100 + "vw";
  s.style.fontSize = (12 + Math.random() * 16) + "px";
  s.style.animationDuration = (6 + Math.random() * 9) + "s";
  s.style.animationDelay = (-Math.random() * 10) + "s";
  s.style.opacity = (0.55 + Math.random() * 0.35).toFixed(2);
  document.body.appendChild(s);
}

/* ===== AI ç²’å­ç½‘ç»œç‰¹æ•ˆï¼ˆè½»é‡ï¼‰ ===== */
const canvas = document.getElementById("aiCanvas");
const ctx = canvas.getContext("2d");
let w, h, particles = [];
const COUNT = 52;
const LINK_DIST = 120;

function resize(){
  w = canvas.width = window.innerWidth * devicePixelRatio;
  h = canvas.height = window.innerHeight * devicePixelRatio;
  canvas.style.width = window.innerWidth + "px";
  canvas.style.height = window.innerHeight + "px";
}
window.addEventListener("resize", resize);
resize();

function rand(min,max){ return Math.random()*(max-min)+min; }

function initParticles(){
  particles = Array.from({length: COUNT}, () => ({
    x: rand(0,w), y: rand(0,h),
    vx: rand(-0.25,0.25) * devicePixelRatio,
    vy: rand(-0.25,0.25) * devicePixelRatio,
    r: rand(1.2,2.4) * devicePixelRatio
  }));
}
initParticles();

function draw(){
  ctx.clearRect(0,0,w,h);

  // ç‚¹
  for(const p of particles){
    p.x += p.vx; p.y += p.vy;

    if(p.x<0||p.x>w) p.vx*=-1;
    if(p.y<0||p.y>h) p.vy*=-1;

    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fillStyle = "rgba(255,255,255,0.55)";
    ctx.fill();
  }

  // çº¿ï¼ˆè¿‘è·ç¦»è¿æ¥ï¼‰
  for(let i=0;i<particles.length;i++){
    for(let j=i+1;j<particles.length;j++){
      const a = particles[i], b = particles[j];
      const dx = a.x-b.x, dy = a.y-b.y;
      const d = Math.hypot(dx,dy);
      if(d < LINK_DIST * devicePixelRatio){
        const alpha = (1 - d/(LINK_DIST*devicePixelRatio)) * 0.22;
        ctx.strokeStyle = `rgba(207,162,74,${alpha})`;
        ctx.lineWidth = 1 * devicePixelRatio;
        ctx.beginPath();
        ctx.moveTo(a.x,a.y);
        ctx.lineTo(b.x,b.y);
        ctx.stroke();
      }
    }
  }

  requestAnimationFrame(draw);
}
draw();

/* ===== éŸ³ä¹ï¼ˆå¯æ’­æ”¾/æš‚åœï¼Œå¹¶æ›´æ–°æŒ‰é’®æ–‡å­—ï¼‰ ===== */
const bgm = document.getElementById("bgm");
const musicBtn = document.getElementById("musicBtn");
let playing = false;
bgm.volume = 0.08;

function fadeIn(){
  let v = 0.08;
  const t = setInterval(() => {
    v += 0.03;
    bgm.volume = Math.min(v, 0.5);
    if(v >= 0.5) clearInterval(t);
  }, 90);
}

async function playMusic(){
  musicBtn.textContent = "â³ æ’­æ”¾ä¸­â€¦";
  try{
    await bgm.play();
    playing = true;
    fadeIn();
    musicBtn.textContent = "â¸ï¸ æš‚åœéŸ³ä¹";
  }catch(e){
    musicBtn.textContent = "ğŸµ å†ç‚¹ä¸€æ¬¡";
    alert("æµè§ˆå™¨é™åˆ¶éŸ³é¢‘æ’­æ”¾ï¼šè¯·å†ç‚¹ä¸€æ¬¡æŒ‰é’®ï¼ˆæˆ–ç‚¹ä¸€ä¸‹é¡µé¢ç©ºç™½å¤„ï¼‰å†è¯•ã€‚");
  }
}

function pauseMusic(){
  bgm.pause();
  playing = false;
  musicBtn.textContent = "ğŸµ æ’­æ”¾åœ£è¯æ­Œ";
}

musicBtn.addEventListener("click", () => {
  if(!playing) playMusic();
  else pauseMusic();
});

document.addEventListener("visibilitychange", () => {
  if(document.hidden && playing){
    pauseMusic();
  }
});
</script>

</body>
</html>
